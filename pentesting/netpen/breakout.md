# Breaking out of restricted environments
Here are some resources that are handy to have when you need to try to "break out" of restricted environments such as Citrix portals, RDP sessions, kiosks, etc.

A few excellent articles to bookmark, like *now*:

* [Breaking Out of Citrix and other Restricted Desktop Environments](https://www.pentestpartners.com/blog/breaking-out-of-citrix-and-other-restricted-desktop-environments/) covers all sorts of attack vectors, from abusing dialog boxes to exploiting weak credentials.

* [Breaking Out! of Applications Deployed via Terminal Services, Citrix, and Kiosks](https://blog.netspi.com/breaking-out-of-applications-deployed-via-terminal-services-citrix-and-kiosks/) is also a great post on finding ways to break out of limitations set on your Citrix/kiosk session.

## A short "can I run this?" checklist
If you can pop any of these executables, you may be able to use them for further exploration and exploitation:

* Cmd.exe (also try via batch file with `cmd /k pause`)
* Command.com
* Cscript
* Ftp
* InstallUtil
* Mspaint
* Powershell.exe (often at `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe`)
* Powershell_ise.exe (often at `C:\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe`)
* Regsvr32
* Rundll32
* Taskmgr
* Taskschd
* Telnet
* Wscript

## Can't run an .exe?  How about rename it?
I just had a pentest where I copied `powershell.exe` to the desktop, named it `p.exe` and it ran like a champ.

## Sticky Keys Slayer
[This tool](https://github.com/linuz/Sticky-Keys-Slayer) connects to an RDP host (or a list of them) to see if the accessibility features can be accessed.  

			