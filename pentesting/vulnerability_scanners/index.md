# Vulnerability Scanners

Nessus
--------
### Install Lets Encrypt certificate on Nessus
Make sure your Lets Encrypt cert is [already generated](https://certbot.eff.org/) and available in the `/etc/letsencrypt/live/F.Q.D.N` folder.  

Stop Nessus with `/etc/init.d/nessusd stop`

Use the following script (thank you [http://bbouille.github.io/2016/02/23/letsencrypt-for-nessus/](http://bbouille.github.io/2016/02/23/letsencrypt-for-nessus/)!!!) to copy the necessary cert files over:

    sudo cp -i /etc/letsencrypt/live/THE.FQDN.OF-YOUR.SERVER/fullchain.pem /opt/nessus/com/nessus/CA/servercert.pem
    sudo cp -i /etc/letsencrypt/live/THE.FQDN.OF-YOUR.SERVER/privkey.pem /opt/nessus/var/nessus/CA/serverkey.pem
    sudo cp -i /etc/letsencrypt/live/THE.FQDN.OF-YOUR.SERVER/chain.pem /opt/nessus/com/nessus/CA/cacert.pem

Start Nessus with `/etc/init.d/nessusd start`

That's it!  BAM!

### Parsing/combining raw .nessus files
Many times I break my Nessus scans up into smaller chunks - such as by site - so that the load on the network is a bit more focused.  However, at the end of the day it's a pain to try to combine these into a single .csv manually.  Fortunately, [Yet Another Nessus Parser](https://github.com/adipinto/yet-another-nessus-parser) makes that a snap!  Just get all the .nessus files into a folder, such as `/combine` and then run:

`/opt/yanp/yanp.py -i /combine --csv /wherever/I/want/to/save/the/big.csv`

Openvas
-------
Offensive has a good [primer article on getting Openvas setup in Kali](https://www.kali.org/penetration-testing/openvas-vulnerability-scanning/).  Basically the key commands are:

`apt-get update`
`apt-get dist-upgrade`
`apt-get install openvas`
`openvas-setup`

Pay close attention to the end of the setup - an admin pw will be generate for you!  If you missed that or need to reset admin pw:

`sudo openvasmd --user=admin --new-password=THENEWPASSWORD`

Then open https://YOUR.LOCAL.IP.ADDRESS:9392, and you should be good to freakin' go!

Vulnerability Databases
--------
Scanners like [Nessus](pentesting/vulnerability-scanners/nessus.md) and [OpenVAS](pentesting/vulnerability-scanners/openvas.md) have enormous databases of vulnerabilities built right in.  However, it's still good to check some online resources for exploits you see in those hard-to-reach places.

* [ExploitDB](http://exploit-db.com) -  hosted by the fine folks at OffSec and is pretty much the go-to vulnerability database for pentesters.  Using [Searchsploit](https://www.exploit-db.com/searchsploit/) makes it *extra* easy to find the vulns you're looking for!

* [Joomla](http://joomla.or) keeps a database of [known vulnerabilities](https://vel.joomla.org/live-vel) continually up to date.

* [SecurityFocus](http://www.securityfocus.com/vulnerabilities) - has vuln write-ups as well as white papers, blogs and tech articles.

* [Web Hacking Incident Database (WHID)](https://docs.google.com/spreadsheets/d/1xZPAw1uCdLqDz8F_Vz57DRvCNJTcCnPgtG7P-yeloUc/edit#gid=1) - appears to be outdated or not maintained anymore?

* [WPVulndb.com](https://wpvulndb.com/) - a large collection of Wordpress core, plugin and theme vulnerabilities.
